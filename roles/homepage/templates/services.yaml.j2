# roles/homepage/templates/services.yaml.j2
---
- Media:
{% if homepage_jellyfin_enabled | default(true) %}
    - Jellyfin:
        icon: jellyfin.png
        href: "{{ homepage_jellyfin_url }}"
        description: Media Server
        widget:
          type: jellyfin
          url: "{{ homepage_jellyfin_url }}"
          key: "{{ homepage_jellyfin_api_key }}"
          enableBlocks: true
          enableNowPlaying: true
          enableUser: true
          showEpisodeNumber: true
          fields: ["movies", "series", "episodes", "songs"]
{% endif %}
    - FreshRSS:
        icon: freshrss.png
        href: "{{ homepage_freshrss_url }}"
        description: RSS Aggregator
        widget:
          type: freshrss
          url: "{{ homepage_freshrss_url }}"
          username: "{{ freshrss_username }}"
          password: "{{ freshrss_password }}"
    - Navidrome:
        icon: navidrome.png
        href: "{{ navidrome_url }}"
        description: Music Server
        widget:
          type: navidrome
          url: "{{ navidrome_url }}"
          user: username
          token: token
          salt: randomsalt


- Infrastructure:
    - Kubernetes Dashboard:
        icon: kubernetes.png
        href: "{{ homepage_k8s_dashboard_url }}"
        description: Cluster Management
        widget:
          type: kubernetes
          cluster: {{ homepage_k8s_cluster_name | default('homelab') }}
    - Pihole:
        icon: pihole.png
        href: "{{ homepage_pihole_url }}"
        description: Cluster Management
        widget:
          type: pihole
          url: "{{ homepage_pihole_url }}"
          version: 6 # required if running v6 or higher, defaults to 5
          key: "{{ pihole_pass }}"
    - Uptime Kuma:
        icon: uptimekuma.png
        href: "{{ uptime_kuma_url }}"
        description: Cluster Management
        widget:
          type: uptimekuma
          url: "{{ uptime_kuma_url }}"
          slug: pinepods-services

    - Proxmox:
        icon: proxmox.png
        href: "{{ homepage_proxmox_url }}"
        description: Virtualization Platform
        ping: "{{ homepage_proxmox_host }}"

{% if homepage_monitoring_enabled | default(true) %}
- Monitoring:
    - Grafana:
        icon: grafana.png
        href: "{{ homepage_grafana_url }}"
        description: Metrics & Dashboards
        widget:
          type: grafana
          url: "{{ homepage_grafana_url }}"
          username: "{{ grafana_username }}"
          password: "{{ grafana_password}}"
{% endif %}

- Storage:
    - TruNas:
        icon: trunas.png
        href: "{{ trunas_url }}"
        description: Cluster Management
        widget:
          type: truenas
          url: "{{ trunas_url }}"
          username: "{{ trunas_user }}"
          password: "{{ trunas_pass }}"
          enablePools: false
          nasType: scale
    - Rook Ceph:
        icon: mdi-harddisk
        href: "{{ homepage_rook_url }}"
        description: Distributed Storage
        widget:
          type: kubernetes
          cluster: {{ homepage_k8s_cluster_name | default('homelab') }}
          namespace: rook-ceph

{% if homepage_custom_services is defined %}
- Custom Services:
{% for service in homepage_custom_services %}
    - {{ service.name }}:
        icon: {{ service.icon | default('mdi-application') }}
        href: {{ service.url }}
        description: {{ service.description | default('') }}
{% if service.widget is defined %}
        widget:
          type: {{ service.widget.type }}
{% for key, value in service.widget.items() %}
{% if key != 'type' %}
          {{ key }}: {{ value }}
{% endif %}
{% endfor %}
{% endif %}
{% endfor %}
{% endif %}